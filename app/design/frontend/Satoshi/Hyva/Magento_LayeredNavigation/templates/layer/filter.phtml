<?php

declare(strict_types=1);

use Hyva\Theme\Model\LocaleFormatter;
use Magento\Catalog\Helper\Data;
use Magento\Framework\Escaper;
use Magento\LayeredNavigation\Block\Navigation\FilterRenderer;

// phpcs:disable Magento2.Templates.ThisInTemplate.FoundThis
// phpcs:disable Magento2.Templates.ThisInTemplate.FoundHelper

/** @var FilterRenderer $block */
/** @var Escaper $escaper */
/** @var LocaleFormatter $localeFormatter */

$catalogHelper = $this->helper(Data::class);

/** @var array $filterItems */
?>

<ol class="items" aria-label="<?= $escaper->escapeHtmlAttr(__('%1 filter options', $block->getFilterTitle())) ?>">
    <?php foreach ($filterItems as $filterItem): ?>
        <li x-data="{
            fetchPage(queryString) {
                this._fetchPage(queryString);
                window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                }
            }"
        >
            <?php if ($filterItem->getCount() > 0): ?>
                <button @click="fetchPage('<?= $escaper->escapeUrl($filterItem->getUrl()) ?>')"
                        class="radio mb-0 h-full w-full py-3"">
                    <span class="radio__control " aria-hidden="true"></span>
                    <span class="radio__label text-md ">
                        <?= /* @noEscape */
                        $filterItem->getLabel() ?>
                    </span>
                    &nbsp;
                    <?php if ($catalogHelper->shouldDisplayProductCountOnLayer()): ?>
                        <span class="count text-primary">(<?= /* @noEscape */
                            $localeFormatter->formatNumber((int)$filterItem->getCount()) ?>)</span>
                    <?php endif; ?>
                </button>
            <?php else: ?>
                <span class="flex justify-between py-1 hover:text-black">
                    <span><?= /* @noEscape */
                        $filterItem->getLabel() ?>
                    </span>

                    <?php if ($catalogHelper->shouldDisplayProductCountOnLayer()): ?>
                        <span class="count text-primary">(<?= /* @noEscape */
                            $localeFormatter->formatNumber((int)$filterItem->getCount()) ?>)</span>
                    <?php endif; ?>
            </span>
            <?php endif; ?>
        </li>
    <?php endforeach ?>
</ol>
