<?xml version="1.0"?>
<page
    layout="3columns"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="urn:magento:framework:View/Layout/etc/page_configuration.xsd"
>
    <!-- Injecting global variables through scripts -->
    <referenceContainer name="head.additional">
        <block name="satoshi-head-styles" template="Magento_Theme::head/head-styles.phtml" />
        <block name="satoshi-head" template="Magento_Theme::head/inject-variables.phtml" />
    </referenceContainer>
    <body>
        <!-- Attributes in body element which required to show correct color of logo text -->
        <attribute name="class" value="gradient" />
        <attribute name="class" value="bg-bg-500" />
        <attribute name="x-data" value="{}" />
        <attribute name="@private-content-loaded.window" value="$store.cart.setCartItems($event.detail.data.cart?.items || []);" />

        <referenceContainer name="root">
            <block class="Magento\Framework\View\Element\Template" name="svg.filters" template="Magento_Theme::html/components/svg-filters.phtml" before="-" />
        </referenceContainer>


        <!-- Start: Wrap content within preview-content comment -->
        <referenceContainer name="main.content">
            <block class="Magento\Framework\View\Element\Template" name="preview.content"
                   template="Magento_Theme::html/layout/preview-content.phtml" before="columns"/>
        </referenceContainer>
        <move element="columns" destination="preview.content" before="-"/>
        <!-- END: Wrap content within preview-content comment -->

        <referenceContainer name="header.container" htmlClass="page-header contents"/>
        <referenceContainer name="page.wrapper" htmlClass="flex min-h-screen max-w-screen flex-col bg-bg-500">
            <container name="main.wrapper" as="main.wrapper" htmlTag="div" htmlClass="main-wrapper">
                <block class="Magento\Framework\View\Element\Template" name="main-content" template="Magento_Theme::html/layout/main-content.phtml" before="-" />
            </container>

            <!-- Transition components -->
            <block class="Magento\Framework\View\Element\Template" name="transition.preview"
                   template="Magento_Theme::html/layout/transition-preview.phtml" after="header.container"/>
        </referenceContainer>

        <!-- TODO: Remove global alerts (uncomment this) -->
        <!-- <referenceContainer name="page.messages" remove="true" /> -->

        <referenceContainer name="main.content" htmlClass="contents" htmlTag="div" />

        <move element="main.content" destination="main-content" />
        <move element="top.container" destination="main.content" before="-" />

        <move element="footer-container" destination="root" after="page.wrapper" />

        <referenceContainer name="footer">
            <!-- Add "footer-wrapper" block so we can teleport footer inside it -->
            <block name="footer-wrapper" template="Magento_Theme::html/footer/wrapper.phtml"/>
            <!-- Add a custom class and 3 CMS blocks to the "footer-content" block -->
            <referenceBlock name="footer-content" class="Satoshi\Theme\Block\Html\Footer">
                <block class="Magento\Cms\Block\Block" name="footer-cms-content-1">
                    <arguments>
                        <argument name="block_id" xsi:type="string">footer-content-1</argument>
                    </arguments>
                </block>
                <block class="Magento\Cms\Block\Block" name="footer-cms-content-2">
                    <arguments>
                        <argument name="block_id" xsi:type="string">footer-content-2</argument>
                    </arguments>
                </block>
                <block class="Magento\Cms\Block\Block" name="footer-cms-content-3">
                    <arguments>
                        <argument name="block_id" xsi:type="string">footer-content-3</argument>
                    </arguments>
                </block>
            </referenceBlock>
        </referenceContainer>

        <!-- Render footer inside main so it can be removed/added when navigating between pages -->
        <move element="footer-content" destination="main.content" after="-" />

        <!-- Render popup wrapper -->
        <referenceContainer name="before.body.end">
            <block name="popup-wrapper" template="Magento_Theme::html/popup/popup-wrapper.phtml" />
        </referenceContainer>
    </body>
</page>
